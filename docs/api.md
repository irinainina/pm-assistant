# PM-assistant API Documentation

Документация по API проекта PM-assistant

## Статус
API в процессе разработки. Здесь перечислены текущие методы.

## Эндпоинты

### Рабочие эндпоинты (используются фронтендом)

#### 1. Вопрос к AI (Ask)
```
POST http://localhost:5000/api/ask?q=тренды веб дизайна
```

Возвращает ответ AI на основе найденных документов, включая источники информации.

#### 2. Проверка статуса актуальности базы данных
```
GET http://localhost:5000/api/notion/status
```

Проверяет, были ли изменения в Notion после последнего обновления векторной базы.

Ответ:
```json
{
  "is_actual": false,
  "notion_last_edited": "2024-01-15T10:30:00.000Z",
  "our_last_update": "2024-01-15T10:25:00.123Z"
}
```

- `is_actual`: true если база актуальна, false если требуется обновление
- `notion_last_edited`: время последнего изменения в Notion (ISO строка)
- `our_last_update`: время последнего обновления нашей базы (ISO строка)


#### 3. Обновление векторной базы данных
```
POST http://localhost:5000/api/notion/update_vector_db
```

Полностью обновляет векторную базу данных: очищает текущую коллекцию и загружает все документы из Notion заново.

Ответ:
```json
{
  "status": "success",
  "message": "Vector database updated successfully with 150 chunks",
  "documents_processed": 15
}
```

### Тестовые эндпоинты (для разработки и отладки)

#### 4. Health-check
```
GET http://localhost:5000/api/health
```

Проверка, что сервер работает. Возвращает простой ответ "ok".

#### 5. Получение документов из Notion
```
GET http://localhost:5000/api/notion/documents/parsed
```

Возвращает список документов из Notion, включая их метаданные и содержимое. Используется для проверки корректности парсинга.

#### 6. Поиск по базе документов (сырые результаты)
```
GET http://localhost:5000/api/chroma?q=тренды веб дизайна
```

Ищет документы по введённому запросу и возвращает сырые результаты поиска (чанки, метаданные, расстояния). Используется для отладки работы векторной базы.

#### 7. Поиск с ответом AI (GET версия)
```
GET http://localhost:5000/api/search?q=тренды веб дизайна
```

Альтернативная GET-версия эндпойнта /ask. Возвращает ответ AI на основе найденных документов.

## Примечания
- Рабочие эндпоинты интегрированы с фронтендом и используются в продакшене
- Тестовые эндпоинты предназначены для разработки, отладки и могут быть отключены в production-среде
- Для основного взаимодействия с AI используйте POST /api/ask
- Для управления базой данных используйте GET /api/notion/status и POST /api/notion/update_vector_db
