# План работы над проектом PM-assistant

## Version 1.0

## 1. Анализ требований и проектирование архитектуры
**Практические результаты:**
- Документ с анализом требований
- Выбор технологического стека
- Схема архитектуры проекта
- План работы над проектом  

**Эстимейт: 16 часов (2 дня)**

## 2. Создание базы данных в Notion
**Практические результаты:**
- Организация 100+ страниц в единую базу данных
- Настройка структуры БД: заголовок, контент, URL, теги
- Проверка доступности всех документов через API

**Эстимейт: 16 часов (2 дня)**

## 3. Интеграция с Notion API
**Практические результаты:**
- Рабочий коннектор к Notion API
- Авторизация и доступ к созданной БД
- Извлечение метаданных документов

**Эстимейт: 16 часов (2 дня)**

## 4. Парсинг и обработка документов
**Практические результаты:**
- Скрипт для рекурсивного обхода блоков Notion
- Очистка и нормализация текста
- Сохранение структуры и иерархии документов
- Извлечение и сохранение URL исходных страниц

**Эстимейт: 16 часов (2 дня)**

## 5. Создание векторной базы данных
**Практические результаты:**
- Настройка ChromaDB
- Чанкинг документов на осмысленные фрагменты
- Генерация эмбеддингов с использованием SentenceTransformers
- Сохранение векторов с метаданными (источники, URL)

**Эстимейт: 24 часа (3 дня)**

## 6. Разработка бэкенда (поиск фрагментов)
**Практические результаты:**
- API endpoint для поиска по векторной БД
- Возврат 3-5 релевантных фрагментов
- Привязка каждого фрагмента к исходному URL в Notion
- Базовая логика ранжирования результатов

**Эстимейт: 24 часа (3 дня)**

## 7. Разработка AI Engine (генерация ответов)
**Практические результаты:**
- Интеграция с OpenAI GPT-4 API
- Prompt engineering для контекстных ответов
- Поддержка русского, английского, украинского языков
- Форматирование ответов с ссылками на источники
- Сохранение контекста диалога

**Эстимейт: 32 часа (4 дня)**

## 8. Реализация контекста диалогов
**Практические результаты:**
- Система хранения истории диалогов
- Поддержка контекста между запросами
- Механизм очистки и управления историей

**Эстимейт: 16 часов (2 дня)**

## 9. Разработка фронтенда
**Практические результаты:**
- Чат-интерфейс на Next.js 15
- Отправка запросов и отображение ответов
- Показ источников с кликабельными ссылками
- История диалогов с сохранением между сессиями

**Эстимейт: 32 часа (4 дня)**

## 10. Тестирование и доработки - не выполнено, перенесено во вторую часть
**Практические результаты:**
- Тест-кейсы по всем сценариям использования
- Юзабилити-тестирование интерфейса
- Исправление ошибок и оптимизация
- Тестирование качества ответов ИИ

**Эстимейт: 32 часа (4 дня)**

---

**Общий эстимейт 1 части проекта: 224 часа (28 дней или 5-6 недель)**


## Version 2.0

## 1. Анализ требований и проектирование архитектуры
**Практические результаты:**
- План работы над проектом 

**Эстимейт: 4 часа (0.5 дня)** 

## 2. Базовая инфраструктура и авторизация
**Практические результаты:**
- Аккаунт в Supabase с созданной таблицей users
- Работающая авторизация через Google с NextAuth.js
- Настроенный Prisma ORM с подключением к Supabase
- Сохранение данных авторизованных пользователей в таблице users

**Эстимейт: 16 часов (2 дня)**

## 3. Проектирование и настройка базы данных
**Практические результаты:**
- Две новые таблицы в Supabase: conversations и messages
- Связи между таблицами (users → conversations → messages)
- Индексы для оптимизации запросов
- Prisma schema с полными моделями
- Примененные миграции в продакшене

**Эстимейт: 8 часов (1 день)**

## 4. Разработка бэкенд API для диалогов пользователя с AI
**Практические результаты:**
- Эндпоинт GET /api/conversations - список диалогов пользователя
- Эндпоинт GET /api/conversations/<id>/messages - сообщения диалога
- Эндпоинт POST /api/conversations - создать новый диалог
- Эндпоинт PUT /api/conversations/<id>/useful - пометить полезным
- Эндпоинт DELETE /api/conversations/<id> - удалить диалог
- Middleware для проверки User-Id заголовка
- Базовые проверки ownership

**Эстимейт: 16 часов (2 дня)**

## 5. Модификация AI чата для сохранения истории
**Практические результаты:**
- Обновленный эндпоинт /ask с поддержкой conversation_id
- Автоматическое создание диалогов для авторизованных пользователей
- Сохранение всех сообщений (user + AI) в базу данных
- Генерация названий диалогов из первых 50 символов вопроса
- Совместимость с неавторизованными пользователями (localStorage)

**Эстимейт: 16 часов (2 дня)**

## 6. Фронтенд - сервисы API и базовая интеграция
**Практические результаты:**
- API сервисы в frontend/lib/api.js для всех операций с диалогами
- Модифицированный AgentSection для определения авторизации
- Логика использования API вместо localStorage для авторизованных
- Сохранение текущего conversation_id в состоянии
- Обновленная логика "New Chat" для обоих сценариев

**Эстимейт: 16 часов (2 дня)**

## 7. Компонент боковой панели диалогов
**Практические результаты:**
- Компонент ConversationSidebar с списком диалогов
- Отображение названий, дат последней активности
- Индикатор полезных диалогов (звездочка/иконка)
- Кнопки удаления диалогов с подтверждением
- Collapsible функциональность для мобильных устройств

**Эстимейт: 16 часов (2 дня)**

## 8. Компонент истории сообщений и главная страница
**Практические результаты:**
- Компонент ChatHistory для отображения сообщений конкретного диалога
- Обновленная главная страница с условным рендерингом
- Авторизованные: Sidebar + ChatHistory + AgentSection
- Неавторизованные: только AgentSection
- Навигация между диалогами

**Эстимейт: 16 часов (2 дня)**

## 9. Функциональность управления диалогами
**Практические результаты:**
- Toggle для добавления/снятия пометки "полезный диалог"
- Поиск по названиям диалогов в боковой панели
- Сортировка диалогов по дате последней активности
- Skeleton loading при загрузке списка диалогов
- Обработка ошибок API (toast уведомления)

**Эстимейт: 16 часов (2 дня)**

## 10. Интеграция и edge cases
**Практические результаты:**
- Автоматическое открытие последнего активного диалога
- Обработка авторизации во время активного диалога
- Синхронизация состояния между компонентами
- Базовая обработка сетевых ошибок
- Responsive дизайн для мобильных устройств

**Эстимейт: 8 часов (1 день)**

## 11. Тестирование и финальные доработки
**Практические результаты:**
- Тестирование всех сценариев использования (авторизованный/неавторизованный)
- Проверка работы на мобильных устройствах
- Тестирование производительности с большим количеством диалогов
- Исправление багов и улучшение UI/UX
- Code review и рефакторинг

**Эстимейт: 20 часов (2.5 дня)**

---

**Общий эстимейт 2 части проекта: 160 часов (20 дней или 4 недели)**
